---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import { siteConfig } from '../../site.config';

const title = 'FreshBlogs â€” 59 Free Interactive Tools, Quizzes & Daily Inspiration';
const description = 'Explore 13 topics with 59+ free tools: personality quizzes, tarot readings, dream dictionary, pet matching, recipe tools, travel planners, and more. No sign-up required.';

const websiteLd = {
  '@context': 'https://schema.org',
  '@type': 'WebSite',
  name: 'FreshBlogs',
  url: siteConfig.url,
  description,
  publisher: { '@type': 'Organization', name: 'FreshBlogs Editorial Team', url: siteConfig.url },
};

// Load latest articles from all collections
const collections = ['astrology-blog','tarot-blog','numerology-blog','dreams-blog','personality-blog','manifest-blog','quotes-blog','pets-blog','recipes-blog','ai-blog','travel-blog','diy-blog','garden-blog'];
const collectionToSite: Record<string,string> = {
  'astrology-blog':'astrology','tarot-blog':'tarot','numerology-blog':'numerology','dreams-blog':'dreams',
  'personality-blog':'personality','manifest-blog':'manifest','quotes-blog':'quotes','pets-blog':'pets',
  'recipes-blog':'recipes','ai-blog':'ai','travel-blog':'travel','diy-blog':'diy','garden-blog':'garden',
};

let allArticles: any[] = [];
for (const col of collections) {
  try {
    const posts = await getCollection(col as any);
    const siteName = collectionToSite[col];
    const siteData = siteConfig.sites.find((s: any) => s.slug === siteName);
    posts.forEach((p: any) => {
      allArticles.push({ ...p, siteName, siteEmoji: siteData?.emoji || 'ðŸ“' });
    });
  } catch {}
}
const latestArticles = allArticles
  .sort((a, b) => b.data.publishDate.getTime() - a.data.publishDate.getTime())
  .slice(0, 9);

const featuredTools = [
  { name: 'Zodiac Compatibility', emoji: 'ðŸ’•', path: '/astrology/tools/compatibility/', desc: 'Check your love match', category: 'Astrology' },
  { name: 'MBTI Personality Quiz', emoji: 'ðŸ§ ', path: '/personality/tools/mbti/', desc: 'Discover your type', category: 'Personality' },
  { name: 'Spirit Animal Quiz', emoji: 'ðŸ¦…', path: '/personality/tools/spirit-animal/', desc: 'Find your animal guide', category: 'Quiz' },
  { name: 'Daily Tarot Pull', emoji: 'ðŸƒ', path: '/tarot/tools/daily-pull/', desc: 'Your card of the day', category: 'Tarot' },
  { name: 'Dream Dictionary', emoji: 'ðŸŒ™', path: '/dreams/tools/dictionary/', desc: '5,000+ dream symbols', category: 'Dreams' },
  { name: 'AI vs Human Quiz', emoji: 'ðŸ¤–', path: '/ai/tools/ai-vs-human/', desc: 'Can you spot AI text?', category: 'AI' },
  { name: 'Pet Match Quiz', emoji: 'ðŸ¾', path: '/pets/tools/pet-match/', desc: 'Find your ideal pet', category: 'Pets' },
  { name: 'Quote Image Maker', emoji: 'ðŸ–¼ï¸', path: '/quotes/tools/image-maker/', desc: 'Create shareable quotes', category: 'Quotes' },
  { name: 'Dinner Spinner', emoji: 'ðŸŽ°', path: '/recipes/tools/spinner/', desc: 'What to eat tonight?', category: 'Recipes' },
  { name: 'Destination Quiz', emoji: 'ðŸŒ', path: '/travel/tools/destination-quiz/', desc: 'Find your dream trip', category: 'Travel' },
  { name: 'Project Cost Estimator', emoji: 'ðŸ’°', path: '/diy/tools/cost-estimator/', desc: 'Estimate DIY costs', category: 'DIY' },
  { name: 'Planting Calendar', emoji: 'ðŸ“…', path: '/garden/tools/planting-calendar/', desc: 'When to plant in your zone', category: 'Garden' },
];

const formatDate = (d: Date) => d.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
---

<BaseLayout title={title} description={description} jsonLd={websiteLd}>
  <!-- Hero -->
  <section class="relative overflow-hidden py-16 md:py-24">
    <div class="absolute inset-0 bg-gradient-to-b from-primary/20 via-dark to-dark"></div>
    <div class="relative max-w-6xl mx-auto px-4 text-center">
      <h1 class="text-4xl md:text-6xl font-display font-bold mb-4 bg-gradient-to-r from-purple-400 via-pink-400 to-yellow-400 bg-clip-text text-transparent">
        59 Free Tools. 13 Topics. Zero Sign-ups.
      </h1>
      <p class="text-lg md:text-xl text-gray-300 max-w-2xl mx-auto mb-8">
        Personality quizzes, tarot readings, dream analysis, pet matching, recipe tools, travel planners â€” all free, all interactive, updated daily.
      </p>
      <div class="flex flex-wrap justify-center gap-3">
        <a href="/personality/tools/spirit-animal/" class="px-6 py-3 bg-primary hover:bg-primary/80 rounded-full font-semibold transition-colors">
          ðŸ¦… Find Your Spirit Animal
        </a>
        <a href="/astrology/tools/compatibility/" class="px-6 py-3 bg-white/10 hover:bg-white/20 rounded-full font-semibold transition-colors">
          ðŸ’• Check Compatibility
        </a>
        <a href="/ai/tools/ai-vs-human/" class="px-6 py-3 bg-white/10 hover:bg-white/20 rounded-full font-semibold transition-colors">
          ðŸ¤– AI vs Human Quiz
        </a>
      </div>
    </div>
  </section>

  <!-- 13 Topic Cards -->
  <section class="max-w-6xl mx-auto px-4 py-12">
    <h2 class="text-2xl font-display font-bold text-center mb-2">Explore 13 Topics</h2>
    <p class="text-center text-gray-500 mb-8">Each topic has 3â€“12 interactive tools plus expert articles</p>
    <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4">
      {siteConfig.sites.map((site) => (
        <a href={`/${site.slug}/`}
          class="group p-5 bg-white/5 hover:bg-white/10 border border-white/10 hover:border-white/20 rounded-xl transition-all duration-300 hover:-translate-y-1">
          <div class="text-3xl mb-2">{site.emoji}</div>
          <h3 class="font-bold text-white group-hover:text-primary transition-colors">{site.name}</h3>
          <p class="text-sm text-gray-400 mt-1 line-clamp-2">{site.description}</p>
        </a>
      ))}
    </div>
  </section>

  <!-- Latest Articles (important for AdSense) -->
  {latestArticles.length > 0 && (
    <section class="max-w-6xl mx-auto px-4 py-12">
      <h2 class="text-2xl font-display font-bold text-center mb-2">Latest Articles</h2>
      <p class="text-center text-gray-500 mb-8">Expert guides from our editorial team</p>
      <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4">
        {latestArticles.map((post) => (
          <a href={`/${post.siteName}/blog/${post.id}/`}
            class="group p-5 bg-white/5 hover:bg-white/10 border border-white/10 hover:border-purple-500/30 rounded-xl transition-all">
            <div class="flex items-center gap-2 mb-2">
              <span class="text-sm">{post.siteEmoji}</span>
              <span class="text-[10px] text-gray-500 uppercase">{post.siteName}</span>
              <span class="text-[10px] text-gray-600 ml-auto">{formatDate(post.data.publishDate)}</span>
            </div>
            <h3 class="font-bold text-white group-hover:text-primary transition-colors text-sm leading-snug">{post.data.title}</h3>
            <p class="text-xs text-gray-400 mt-2 line-clamp-2">{post.data.description}</p>
          </a>
        ))}
      </div>
    </section>
  )}

  <!-- Popular Tools -->
  <section class="max-w-6xl mx-auto px-4 py-12">
    <h2 class="text-2xl font-display font-bold text-center mb-2">Popular Tools</h2>
    <p class="text-center text-gray-500 mb-8">Fan favorites from across all 13 topics</p>
    <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-3">
      {featuredTools.map((tool) => (
        <a href={tool.path} class="group flex items-center gap-4 p-4 bg-white/5 hover:bg-white/10 rounded-xl transition-colors border border-white/10 hover:border-purple-500/30">
          <span class="text-3xl">{tool.emoji}</span>
          <div>
            <h3 class="font-bold text-white group-hover:text-primary transition-colors text-sm">{tool.name}</h3>
            <p class="text-xs text-gray-400">{tool.desc}</p>
          </div>
          <span class="ml-auto text-[10px] text-gray-600 bg-white/5 px-2 py-0.5 rounded-full whitespace-nowrap">{tool.category}</span>
        </a>
      ))}
    </div>
  </section>

  <!-- Stats -->
  <section class="max-w-6xl mx-auto px-4 py-12">
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
      <div class="p-5 bg-white/5 rounded-xl border border-white/10 text-center">
        <div class="text-3xl font-bold text-purple-400">59</div>
        <p class="text-sm text-gray-400 mt-1">Interactive Tools</p>
      </div>
      <div class="p-5 bg-white/5 rounded-xl border border-white/10 text-center">
        <div class="text-3xl font-bold text-pink-400">13</div>
        <p class="text-sm text-gray-400 mt-1">Topic Areas</p>
      </div>
      <div class="p-5 bg-white/5 rounded-xl border border-white/10 text-center">
        <div class="text-3xl font-bold text-cyan-400">90+</div>
        <p class="text-sm text-gray-400 mt-1">Expert Articles</p>
      </div>
      <div class="p-5 bg-white/5 rounded-xl border border-white/10 text-center">
        <div class="text-3xl font-bold text-green-400">$0</div>
        <p class="text-sm text-gray-400 mt-1">Always Free</p>
      </div>
    </div>
  </section>

  <!-- About -->
  <section class="max-w-6xl mx-auto px-4 py-12">
    <div class="bg-white/5 rounded-2xl border border-white/10 p-8 text-center">
      <h2 class="text-2xl font-display font-bold mb-4">About FreshBlogs</h2>
      <p class="text-gray-300 max-w-2xl mx-auto mb-6">
        FreshBlogs is a collection of 59 free interactive tools and 90+ expert articles across 13 topics â€” from astrology and personality quizzes to recipe tools and garden planners. Our editorial team creates engaging content updated daily. No accounts, no subscriptions â€” just tools that help you discover, learn, and have fun.
      </p>
      <a href="/about/" class="inline-block px-6 py-2 bg-white/10 hover:bg-white/20 rounded-full transition-colors">
        Meet Our Team â†’
      </a>
    </div>
  </section>
</BaseLayout>
