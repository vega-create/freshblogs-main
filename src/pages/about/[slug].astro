---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { siteConfig } from '../../../site.config';

export function getStaticPaths() {
  return siteConfig.authors.map((author) => ({
    params: { slug: author.slug },
    props: { author },
  }));
}

const { author } = Astro.props;
const authorSites = siteConfig.sites.filter((s) => author.sites.includes(s.slug));

const title = `${author.name} — ${author.role}`;
const description = `${author.name} is the ${author.role} at FreshBlogs, covering ${authorSites.map(s => s.name).join(', ')}.`;

const personLd = {
  '@context': 'https://schema.org',
  '@type': 'Person',
  name: author.name,
  jobTitle: author.role,
  description: author.bio,
  url: `${siteConfig.url}/about/${author.slug}/`,
  worksFor: {
    '@type': 'Organization',
    name: siteConfig.name,
    url: siteConfig.url,
  },
};

const breadcrumbLd = {
  '@context': 'https://schema.org',
  '@type': 'BreadcrumbList',
  itemListElement: [
    { '@type': 'ListItem', position: 1, name: 'Home', item: siteConfig.url },
    { '@type': 'ListItem', position: 2, name: 'About', item: `${siteConfig.url}/about/` },
    { '@type': 'ListItem', position: 3, name: author.name, item: `${siteConfig.url}/about/${author.slug}/` },
  ],
};
---

<BaseLayout title={title} description={description} jsonLd={[personLd, breadcrumbLd]}>
  <div class="max-w-3xl mx-auto px-4 py-12">
    <!-- Breadcrumb -->
    <nav class="text-sm text-gray-400 mb-8">
      <a href="/" class="hover:text-white">Home</a>
      <span class="mx-2">/</span>
      <a href="/about/" class="hover:text-white">About</a>
      <span class="mx-2">/</span>
      <span class="text-white">{author.name}</span>
    </nav>

    <!-- Author Header -->
    <div class="flex items-start gap-6 mb-8">
      <div class="w-24 h-24 bg-primary/20 rounded-full flex items-center justify-center text-4xl flex-shrink-0">
        {author.name.charAt(0)}
      </div>
      <div>
        <h1 class="text-3xl font-display font-bold">{author.name}</h1>
        <p class="text-primary text-lg">{author.role}</p>
        <div class="flex flex-wrap gap-2 mt-3">
          {authorSites.map((site) => (
            <a
              href={`/${site.slug}/`}
              class="text-sm px-3 py-1 bg-white/5 hover:bg-white/10 rounded-full transition-colors"
            >
              {site.emoji} {site.name}
            </a>
          ))}
        </div>
      </div>
    </div>

    <!-- Bio -->
    <div class="prose prose-invert max-w-none">
      <p class="text-gray-300 text-lg leading-relaxed">{author.bio}</p>
    </div>

    <!-- Topics Covered -->
    <section class="mt-12">
      <h2 class="text-xl font-bold mb-4">Topics by {author.name.split(' ')[0]}</h2>
      <div class="grid gap-3">
        {authorSites.map((site) => (
          <a
            href={`/${site.slug}/`}
            class="flex items-center gap-4 p-4 bg-white/5 hover:bg-white/10 rounded-xl border border-white/10 transition-colors"
          >
            <span class="text-2xl">{site.emoji}</span>
            <div>
              <h3 class="font-bold">{site.name}</h3>
              <p class="text-sm text-gray-400">{site.description}</p>
            </div>
          </a>
        ))}
      </div>
    </section>

    <!-- Back -->
    <div class="mt-12">
      <a href="/about/" class="text-primary hover:text-white transition-colors">
        ← Back to Team
      </a>
    </div>
  </div>
</BaseLayout>
